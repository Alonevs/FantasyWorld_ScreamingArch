{% extends 'layouts/base.html' %}
{% load static %}

{% block title %}Nuevo Mensaje | ECLAI Universe{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto px-4 py-12">
    <div class="animate-fade-in-up">
        <a href="{% url 'inbox' %}" class="inline-flex items-center gap-2 text-gray-500 hover:text-white transition-colors mb-8 group uppercase font-black text-xs tracking-widest">
            <span class="group-hover:-translate-x-1 transition-transform">‚¨Ö</span> VOLVER ATR√ÅS
        </a>
        
        <h1 class="text-4xl font-black tracking-tighter text-white mb-2">
            REDACTAR <span class="text-blue-500">MENSAJE</span>
        </h1>
        <p class="text-gray-400 text-lg mb-12">Env√≠a un mensaje privado a cualquier usuario del sistema.</p>

        <form method="POST" class="space-y-6">
            {% csrf_token %}
            
            <div class="bg-card/50 backdrop-blur-xl border border-white/10 rounded-3xl p-8 space-y-6 shadow-2xl">
                <!-- Recipient -->
                <div class="space-y-2">
                    <label class="block text-xs font-black text-gray-500 tracking-widest uppercase">Destinatario</label>
                    <select name="recipient" required class="w-full bg-dark/80 border border-white/10 rounded-2xl px-6 py-4 text-white focus:outline-none focus:border-blue-500 transition-colors appearance-none cursor-pointer">
                        <option value="" disabled {% if not initial_recipient %}selected{% endif %}>Selecciona un usuario...</option>
                        {% for u in users %}
                            <option value="{{ u.id }}" {% if initial_recipient and initial_recipient.id == u.id %}selected{% endif %}>
                                {{ u.username }} {% if u.profile.rank %}({{ u.profile.rank }}){% endif %}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Subject -->
                <div class="space-y-2">
                    <label class="block text-xs font-black text-gray-500 tracking-widest uppercase">Asunto</label>
                    <input type="text" name="subject" required placeholder="¬øDe qu√© trata este mensaje?"
                           class="w-full bg-dark/80 border border-white/10 rounded-2xl px-6 py-4 text-white placeholder:text-gray-600 focus:outline-none focus:border-blue-500 transition-colors">
                </div>

                <!-- Body -->
                <div class="space-y-2">
                    <label class="block text-xs font-black text-gray-500 tracking-widest uppercase">Mensaje</label>
                    <textarea name="body" required rows="8" placeholder="Escribe tu mensaje aqu√≠..."
                              class="w-full bg-dark/80 border border-white/10 rounded-2xl px-6 py-4 text-white placeholder:text-gray-600 focus:outline-none focus:border-blue-500 transition-colors resize-none"></textarea>
                </div>
            </div>

            <div class="flex items-center justify-end gap-4 pt-4">
                <button type="submit" class="w-full md:w-auto bg-blue-600 hover:bg-blue-500 text-white font-black px-12 py-5 rounded-2xl transition-all duration-300 shadow-xl shadow-blue-500/20 hover:scale-105 active:scale-95 flex items-center justify-center gap-3">
                    <span>üöÄ</span> ENVIAR MENSAJE
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
