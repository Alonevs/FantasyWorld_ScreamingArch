{% extends "layouts/base.html" %}

{% block title %}Mapa Estructural | {{ root_name }}{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto p-6">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row justify-between items-center mb-8 border-b border-gray-800 pb-4">
        <h1 class="text-2xl font-bold text-accent uppercase tracking-widest mb-4 sm:mb-0">
            üó∫Ô∏è Estructura: {{ root_name }}
        </h1>
        <a href="javascript:history.back()" class="px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded-lg border border-gray-700 transition flex items-center gap-2">
            ‚¨Ö Volver
        </a>
    </div>

    <!-- Tree Container -->
    <div class="bg-card border border-gray-800 rounded-xl p-6 shadow-2xl overflow-x-auto">
        {% for item in tree %}
        <a href="{% url 'ver_mundo' item.public_id %}" class="flex items-center px-3 py-2 border-b border-gray-800/50 hover:bg-white/5 transition rounded group {% if item.is_root %}text-accent font-bold{% else %}text-gray-400 hover:text-white{% endif %}">
            <!-- Indentation -->
            <div style="width: {{ item.indent_px }}px;" class="flex-shrink-0"></div>
            
            <!-- Connector & Badge -->
            {% if not item.is_root %}
                <span class="text-gray-600 font-mono mr-2">‚îî‚îÄ</span>
            {% endif %}
            
            <span class="font-mono text-xs bg-black/40 text-gray-500 px-1.5 py-0.5 rounded mr-3 border border-gray-800">
                {{ item.id_display }}
            </span>
            
            <!-- Name -->
            <span class="text-lg {% if item.is_root %}underline decoration-accent/30 underline-offset-4{% endif %} mr-auto">
                {{ item.name }}
            </span>

            <!-- Status Dot -->
            <span class="w-2.5 h-2.5 rounded-full ml-4 shadow-sm
                {% if item.status == 'LIVE' %}bg-green-500 shadow-green-500/50{% else %}bg-orange-500{% endif %}" 
                title="{{ item.status }}">
            </span>
        </a>
        {% empty %}
            <div class="text-center py-10 text-gray-500 italic">
                El vac√≠o es absoluto. No hay estructura visible.
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}